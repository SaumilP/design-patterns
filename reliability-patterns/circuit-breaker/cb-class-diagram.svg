<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="650" viewBox="0 0 1100 650">
  <defs>
    <style type="text/css"><![CDATA[
      .box { fill:#ffffff; stroke:#111827; stroke-width:2; rx:14; ry:14; }
      .title { font-family: DejaVu Sans, Arial, sans-serif; font-size:20px; font-weight:700; fill:#111827; }
      .text { font-family: DejaVu Sans, Arial, sans-serif; font-size:14px; fill:#111827; }
      .muted { fill:#374151; }
      .arrow { stroke:#111827; stroke-width:2; fill:none; marker-end:url(#arrowhead); }
      .dash { stroke-dasharray:6 6; }
    ]]></style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#111827"/>
    </marker>
  </defs>

  <rect x="60" y="70" width="520" height="360" class="box"/>
  <text x="85" y="110" class="title">CircuitBreaker</text>
  <line x1="60" y1="130" x2="580" y2="130" stroke="#111827" stroke-width="2"/>
  <text x="85" y="160" class="text muted">+ builder(name): Builder</text>
  <text x="85" y="185" class="text muted">+ execute(op): T</text>
  <text x="85" y="210" class="text muted">+ executeUnchecked(op): T</text>
  <text x="85" y="235" class="text muted">+ state(): State</text>
  <text x="85" y="260" class="text muted">+ demoWithVirtualThreads(tasks, op)</text>
  <line x1="60" y1="285" x2="580" y2="285" stroke="#111827" stroke-width="2"/>
  <text x="85" y="315" class="text muted">State: CLOSED / OPEN / HALF_OPEN</text>
  <text x="85" y="340" class="text muted">Transitions: CLOSED→OPEN→HALF_OPEN→CLOSED</text>
  <text x="85" y="365" class="text muted">Open window: openUntil (Clock-based)</text>

  <rect x="650" y="70" width="400" height="200" class="box"/>
  <text x="675" y="110" class="title">CircuitBreaker.Builder</text>
  <line x1="650" y1="130" x2="1050" y2="130" stroke="#111827" stroke-width="2"/>
  <text x="675" y="160" class="text muted">+ failureThreshold(n): Builder</text>
  <text x="675" y="185" class="text muted">+ openDuration(d): Builder</text>
  <text x="675" y="210" class="text muted">+ halfOpenMaxCalls(n): Builder</text>
  <text x="675" y="235" class="text muted">+ build(): CircuitBreaker</text>

  <rect x="650" y="320" width="400" height="170" class="box"/>
  <text x="675" y="360" class="title">CircuitBreakerOpenException</text>
  <line x1="650" y1="380" x2="1050" y2="380" stroke="#111827" stroke-width="2"/>
  <text x="675" y="410" class="text muted">extends RuntimeException</text>
  <text x="675" y="435" class="text muted">+ openUntil(): Instant</text>
  <text x="675" y="460" class="text muted">+ state(): CircuitBreaker.State</text>

  <!-- Relationships -->
  <path class="arrow" d="M 580 150 C 620 150, 610 150, 650 150"/>
  <text x="590" y="145" class="text">creates</text>

  <path class="arrow dash" d="M 580 220 C 620 220, 610 220, 650 220"/>
  <text x="590" y="215" class="text">build()</text>

  <path class="arrow" d="M 540 350 C 620 350, 610 410, 650 410"/>
  <text x="560" y="395" class="text">throws</text>
</svg>

