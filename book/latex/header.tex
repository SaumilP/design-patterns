% LaTeX header for the PDF book build (Pandoc + XeLaTeX).

\usepackage{fontspec}
\usepackage{microtype}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{geometry}
\usepackage{titlesec}
\usepackage{hyperref}
\usepackage{fvextra}

% Typography
\setmainfont{TeX Gyre Pagella}
\setsansfont{TeX Gyre Heros}
\setmonofont{DejaVu Sans Mono}

% Links
\hypersetup{
  colorlinks=true,
  linkcolor=black,
  urlcolor=blue,
  citecolor=black
}

% Headings
\titleformat{\chapter}[display]
  {\normalfont\huge\bfseries}
  {\chaptername\ \thechapter}
  {10pt}
  {\Huge}

% Code blocks (Pandoc Highlighting environment)
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{
  breaklines=true,
  breaksymbolleft={},
  fontsize=\small
}

% Header / footer
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE,RO]{\nouppercase{\leftmark}}
\fancyhead[LO,RE]{\nouppercase{\rightmark}}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}

% Ensure chapter opening pages also use the fancy style.
\fancypagestyle{plain}{
  \fancyhf{}
  \fancyhead[LE,RO]{\nouppercase{\leftmark}}
  \fancyhead[LO,RE]{\nouppercase{\rightmark}}
  \fancyfoot[C]{\thepage}
  \renewcommand{\headrulewidth}{0.4pt}
  \renewcommand{\footrulewidth}{0pt}
}
